#!/bin/bash
if (($# < 7)); then
  echo "usage:"
  echo "   run_episode [repetitions] [world_name] [planning_iteration] [particles] [pred_starting_pos_x] [pred_starting_pos_y] [randomness] [path_type]"
else
  world=$2
  planning_iterations=$3
  particles=$4
  x=$5
  y=$6
  randomness=$7
  path_type=$8
  repetitions=$1
  nx=$(($x - 7))
  ny=$((-($y - 7)))
  for ((seed = 1; seed <= $repetitions; seed++)); do
    episode="./habit $world -seed $seed -pi $planning_iterations -k $particles -slx $nx -sly $ny -pr $randomness -path $path_type"
    result=$($episode)
    if [ $? -ne 0 ]; then
      echo "FAILED: $episode ($x;$y)" >&2
    else
      echo "{ \"seed\": $seed, \"predator_start_location\": [$x,$y],\"result\": $result }"
      if (( seed < repetitions )); then
        printf ","
      fi
    fi
  done
fi